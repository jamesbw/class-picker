<html>
	<head>
		<script src="./underscore-min.js"></script>
		<script src="./jquery-1.8.2.min.js"></script>

	</head>
	<body>
		<script>
			$.getJSON('allreq.json',
			  function(reqs) {
			  	$.getJSON('allcourses.json',
			  		function(allcourses){
			  			console.log(reqs, allcourses)

			  			var reqCourses = []
			  			for (var i = reqs.length - 1; i >= 0; i--) {
			  				var req = reqs[i]
			  				var depth = req.depthCourses
			  				var breadth = req.breadthCourses
			  				depth.concat(breadth).forEach(function(c){ reqCourses.push(c.id)})
			  			};
			  			reqCourses = _.uniq(reqCourses)
			  			console.log(reqCourses)

			  			var csCoursesAbove110 = allcourses.filter(function(c){ 
			  				return (c.id.substring(0,2) === "CS") && (parseInt(c.id.match(/CS (\d*)/)[1], 10) > 110)}).map(function(c){return c.id})
			  			console.log(csCoursesAbove110)

			  			var keptIDs = _.uniq(_.union(csCoursesAbove110, reqCourses))


			  			var keptCourses = allcourses.filter(function(c){
			  				return _.contains(keptIDs, c.id)
			  			})

			  			var allIDs = allcourses.map(function(c){return c.id})
			  			var notFound = keptIDs.filter(function(id){
			  				return !_.contains(allIDs, id)
			  			})

			  			console.log(keptIDs.length, keptCourses.length)
			  			console.log(notFound)

			  			$("#output").text(JSON.stringify(keptCourses, null, 4))

			  		})
			  }
			);
		</script>
		<pre id="output"> </pre>
	</body>
</html>